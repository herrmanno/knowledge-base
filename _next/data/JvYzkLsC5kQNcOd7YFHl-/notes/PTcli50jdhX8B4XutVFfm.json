{"pageProps":{"note":{"id":"PTcli50jdhX8B4XutVFfm","title":"Transaktionen","desc":"","updated":1643877542930,"created":1643875169397,"custom":{},"fname":"Datenbanken.Transaktionen","type":"note","vault":{"fsPath":"uni","name":"Uni"},"contentHash":"f96fda4129507cd6a20444916ff61066","links":[{"from":{"fname":"Datenbanken","vaultName":"Uni"},"type":"backlink","position":{"start":{"line":42,"column":1,"offset":1064},"end":{"line":42,"column":30,"offset":1093},"indent":[]},"value":"Datenbanken.Transaktionen","alias":"Datenbanken.Transaktionen"}],"anchors":{"acid":{"type":"header","text":"ACID","value":"acid","line":8,"column":0,"depth":2},"atomicity":{"type":"header","text":"Atomicity","value":"atomicity","line":10,"column":0,"depth":3},"consistency":{"type":"header","text":"Consistency","value":"consistency","line":13,"column":0,"depth":3},"isolation":{"type":"header","text":"Isolation","value":"isolation","line":16,"column":0,"depth":3},"durability":{"type":"header","text":"Durability","value":"durability","line":19,"column":0,"depth":3},"schedules":{"type":"header","text":"Schedules","value":"schedules","line":23,"column":0,"depth":2},"serieller-schedule":{"type":"header","text":"Serieller Schedule","value":"serieller-schedule","line":25,"column":0,"depth":3},"äquivalente-schedules":{"type":"header","text":"Äquivalente Schedules","value":"äquivalente-schedules","line":28,"column":0,"depth":3},"serialisierbarer-schedule":{"type":"header","text":"Serialisierbarer Schedule","value":"serialisierbarer-schedule","line":31,"column":0,"depth":3},"anomalien":{"type":"header","text":"Anomalien","value":"anomalien","line":34,"column":0,"depth":2},"verlorengegangene-änderungen-lost-updates":{"type":"header","text":"Verlorengegangene Änderungen (Lost updates)","value":"verlorengegangene-änderungen-lost-updates","line":36,"column":0,"depth":3},"zugriff-auf-schmutzige-daten-dirty-read":{"type":"header","text":"Zugriff auf schmutzige Daten (Dirty Read)","value":"zugriff-auf-schmutzige-daten-dirty-read","line":41,"column":0,"depth":3},"nicht-wiederholbares-lesen-unrepeatable-read":{"type":"header","text":"Nicht-wiederholbares Lesen (Unrepeatable Read)","value":"nicht-wiederholbares-lesen-unrepeatable-read","line":48,"column":0,"depth":3},"phantom-problem":{"type":"header","text":"Phantom-Problem","value":"phantom-problem","line":53,"column":0,"depth":3},"zwei-phasen-sperrverfahren-2-phase-locking":{"type":"header","text":"Zwei-Phasen-Sperrverfahren (2-Phase-Locking)","value":"zwei-phasen-sperrverfahren-2-phase-locking","line":59,"column":0,"depth":2},"1-phase-wachstumsphase":{"type":"header","text":"1. Phase: Wachstumsphase","value":"1-phase-wachstumsphase","line":61,"column":0,"depth":3},"2-phase-schrumpfungsphase":{"type":"header","text":"2. Phase: Schrumpfungsphase","value":"2-phase-schrumpfungsphase","line":64,"column":0,"depth":3},"problem":{"type":"header","text":"Problem","value":"problem","line":67,"column":0,"depth":3},"striktes-zwei-phasen-sperrverfahren-2-phase-locking":{"type":"header","text":"Striktes Zwei-Phasen-Sperrverfahren (2-Phase-Locking)","value":"striktes-zwei-phasen-sperrverfahren-2-phase-locking","line":72,"column":0,"depth":2},"protokoll":{"type":"header","text":"Protokoll","value":"protokoll","line":76,"column":0,"depth":3},"zurücksetzen-einer-transaktion":{"type":"header","text":"Zurücksetzen einer Transaktion","value":"zurücksetzen-einer-transaktion","line":85,"column":0,"depth":2},"kaskadierender-abort":{"type":"header","text":"Kaskadierender Abort","value":"kaskadierender-abort","line":87,"column":0,"depth":3},"log-datei":{"type":"header","text":"Log-Datei","value":"log-datei","line":92,"column":0,"depth":3},"3-phasen-im-recovery-algorithmus":{"type":"header","text":"3 Phasen im Recovery-Algorithmus","value":"3-phasen-im-recovery-algorithmus","line":96,"column":0,"depth":2},"analyse-lauf":{"type":"header","text":"Analyse-Lauf","value":"analyse-lauf","line":98,"column":0,"depth":3},"redo-lauf":{"type":"header","text":"Redo-Lauf","value":"redo-lauf","line":103,"column":0,"depth":3},"undo-lauf":{"type":"header","text":"Undo-Lauf","value":"undo-lauf","line":107,"column":0,"depth":3}},"children":[],"parent":"GRvxv332whjrUYDFp1Ziq","data":{}},"body":"<h1 id=\"transaktionen\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#transaktionen\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Transaktionen</h1>\n<h2 id=\"acid\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#acid\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>ACID</h2>\n<h3 id=\"atomicity\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#atomicity\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Atomicity</h3>\n<p>Eine Transaktion wird vollständig oder gar nicht ausgeführt</p>\n<h3 id=\"consistency\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#consistency\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Consistency</h3>\n<p>Eine Transaktion hinterlässt die Datenbank in einem konsistenten Zustand</p>\n<h3 id=\"isolation\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#isolation\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Isolation</h3>\n<p>Aktionen einer Transaktion sind für andere Transaktionen nicht sichtbar</p>\n<h3 id=\"durability\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#durability\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Durability</h3>\n<p>Folgen einer Transaktion sind persistent (auch im Falle eines Systemfehlers)</p>\n<h2 id=\"schedules\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#schedules\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Schedules</h2>\n<h3 id=\"serieller-schedule\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#serieller-schedule\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Serieller Schedule</h3>\n<p>Keine Aktionen aus unterschiedlichen Transaktionen ineinander verschachtelt</p>\n<h3 id=\"äquivalente-schedules\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#äquivalente-schedules\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Äquivalente Schedules</h3>\n<p>Effekt der Ausführung zweier Schedules führt zu identischem Datenbankzustand</p>\n<h3 id=\"serialisierbarer-schedule\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#serialisierbarer-schedule\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Serialisierbarer Schedule</h3>\n<p>Schedule, der äquivalent zu irgendeiner seriellen Ausführung der Transaktion ist</p>\n<h2 id=\"anomalien\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#anomalien\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Anomalien</h2>\n<h3 id=\"verlorengegangene-änderungen-lost-updates\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#verlorengegangene-änderungen-lost-updates\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Verlorengegangene Änderungen (Lost updates)</h3>\n<p>Gleichzeitige Änderung desselben Objekts durch zwei Transaktionen</p>\n<p><img src=\"/knowledge-base/assets/images/2022-02-03-09-12-24.png\"></p>\n<h3 id=\"zugriff-auf-schmutzige-daten-dirty-read\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#zugriff-auf-schmutzige-daten-dirty-read\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Zugriff auf <em>schmutzige Daten</em> (Dirty Read)</h3>\n<p>Lesen von Daten, die in einer anderen Transaktion verändert wurden</p>\n<ul>\n<li>Andere Transaktion wird u.U. zurückgerollt</li>\n</ul>\n<p><img src=\"/knowledge-base/assets/images/2022-02-03-09-12-57.png\"></p>\n<h3 id=\"nicht-wiederholbares-lesen-unrepeatable-read\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#nicht-wiederholbares-lesen-unrepeatable-read\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Nicht-wiederholbares Lesen (Unrepeatable Read)</h3>\n<p>Eine Transaktion sieht (aufgrund paralleler Änderungen) unterschiedliche Zustände eines Objekts</p>\n<p><img src=\"/knowledge-base/assets/images/2022-02-03-09-13-08.png\"></p>\n<h3 id=\"phantom-problem\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#phantom-problem\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Phantom-Problem</h3>\n<ol>\n<li>Lesen von Menge mit Prädikat <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span></li>\n<li>Parallele Änderung an Objekten, die unter <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span> fallen</li>\n<li>Folge: Phantom-Objekte, die durch parallele Vorgänge in Ergebnismenge aus 1. auftauchen oder verschwinden</li>\n</ol>\n<h2 id=\"zwei-phasen-sperrverfahren-2-phase-locking\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#zwei-phasen-sperrverfahren-2-phase-locking\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Zwei-Phasen-Sperrverfahren (2-Phase-Locking)</h2>\n<h3 id=\"1-phase-wachstumsphase\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#1-phase-wachstumsphase\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>1. Phase: Wachstumsphase</h3>\n<p>Transaktion darf Sperren anfordern, aber keine freigeben</p>\n<h3 id=\"2-phase-schrumpfungsphase\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#2-phase-schrumpfungsphase\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>2. Phase: Schrumpfungsphase</h3>\n<p>Transaktion darf Sperren freigeben, aber keine neuen anfordern</p>\n<h3 id=\"problem\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#problem\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Problem</h3>\n<ul>\n<li>Bei Systemausfall kann es zu kaskadierendem Abort komme\n<ul>\n<li>Transaktionen, die schon freigegebene Daten haben (und vielleicht selbst schon normal beendet\nwurden) müssen zurückgesetzt werden</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"striktes-zwei-phasen-sperrverfahren-2-phase-locking\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#striktes-zwei-phasen-sperrverfahren-2-phase-locking\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Striktes Zwei-Phasen-Sperrverfahren (2-Phase-Locking)</h2>\n<p>Vermeidung von kaskadierendem Abort, falls Systemabsturz in der Freigabephase</p>\n<h3 id=\"protokoll\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#protokoll\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Protokoll</h3>\n<ul>\n<li>Jede Transaktion muss eine <strong>S</strong>-Sperre (shared lock) auf dem Objekt vor dem Lesen erwerben und\neine <strong>X</strong>-Sperre (exklusive lock) vor dem Schreiben</li>\n<li>Alle Sperren werden bei Beendigung der Transaktion (Commit) freigegeben</li>\n<li>Wenn eine Transaktion eine X-Sperre auf einem Objekt hält kann keine andere Transaktion eine Sperre\nauf diesem Objekt erwerben</li>\n</ul>\n<p><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>⇒</mo></mrow><annotation encoding=\"application/x-tex\">\\Rightarrow</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">⇒</span></span></span></span></span> Nur striktes 2PL erlaubt serialisiebare Schedules</p>\n<h2 id=\"zurücksetzen-einer-transaktion\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#zurücksetzen-einer-transaktion\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Zurücksetzen einer Transaktion</h2>\n<h3 id=\"kaskadierender-abort\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#kaskadierender-abort\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Kaskadierender Abort</h3>\n<ul>\n<li>Führen von Log-Daten einer Transaktion (Aufzeichnung aller Write-Aktionen)</li>\n<li>Auch nutzbar für die Wiederherstellung der Daten bei System-Crash (Recovery): alle Transaktionen,\ndie zum Zeitpunkt des System-Crashs aktiv waren werden beim Wiederanlauf zurückgesetzt</li>\n</ul>\n<h3 id=\"log-datei\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#log-datei\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Log-Datei</h3>\n<p>Speicherung von Änderungsaktionen mit Parametern (alter und neuer Wert)</p>\n<ul>\n<li>Muss auf Platte gespeichert werden vor der geänderten Seite</li>\n</ul>\n<h2 id=\"3-phasen-im-recovery-algorithmus\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#3-phasen-im-recovery-algorithmus\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>3 Phasen im Recovery-Algorithmus</h2>\n<h3 id=\"analyse-lauf\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#analyse-lauf\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Analyse-Lauf</h3>\n<ul>\n<li>Sequentielles Lesen der Log-Datei vom letzten Checkpoint bis zu ihrem Ende</li>\n<li>Bestimme die zum Checkpoint-Zeitpunkt laufenden Transaktionen</li>\n<li>Bestimme davon Gewinner (Ts mit Commit-Eintrag im Log) und Verlierer (Ts mit Rollback)</li>\n</ul>\n<h3 id=\"redo-lauf\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#redo-lauf\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Redo-Lauf</h3>\n<ul>\n<li>Wiederhole die Änderungen, welche noch nicht in den betroffenen Seiten vorliegen (Lese Log dabei\nvon hinten nach Vorne)</li>\n</ul>\n<h3 id=\"undo-lauf\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#undo-lauf\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Undo-Lauf</h3>\n<ul>\n<li>Zurücksetzen der Verlierer-Transaktionen, die während des Crash aktiv waren (durch schreiben des\n<em>before value</em>, der im Log-Satz steht)</li>\n<li>Lesen des Logs von vorne nach hinten, bis zum Beginn der ältesten Transaktion, die beim letzten\nCheckpoint aktiv war</li>\n</ul>\n<hr>\n<strong>Backlinks</strong>\n<ul>\n<li><a href=\"/knowledge-base/notes/GRvxv332whjrUYDFp1Ziq\">Datenbanken</a></li>\n</ul>","noteIndex":{"id":"4PZFYT82ucE5sGWchYy0o","title":"Uni-Inhalte (INB20-1)","desc":"Lerninhalte im Bachelor \"Informatik\"","updated":1644405131757,"created":1642663416518,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"uni","name":"Uni"},"contentHash":"3ce9f1ac3f10b295e17673d466b404ba","links":[{"type":"wiki","from":{"fname":"root","id":"4PZFYT82ucE5sGWchYy0o","vaultName":"Uni"},"value":"Betriebssysteme","alias":"Betriebssysteme","position":{"start":{"line":4,"column":3,"offset":13},"end":{"line":4,"column":22,"offset":32},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"Betriebssysteme"}},{"type":"wiki","from":{"fname":"root","id":"4PZFYT82ucE5sGWchYy0o","vaultName":"Uni"},"value":"Datenbanken","alias":"Datenbanken","position":{"start":{"line":5,"column":3,"offset":35},"end":{"line":5,"column":18,"offset":50},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"Datenbanken"}},{"type":"wiki","from":{"fname":"root","id":"4PZFYT82ucE5sGWchYy0o","vaultName":"Uni"},"value":"Stochastik","alias":"Stochastik","position":{"start":{"line":6,"column":3,"offset":53},"end":{"line":6,"column":17,"offset":67},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"Stochastik"}}],"anchors":{"module":{"type":"header","text":"Module","value":"module","line":8,"column":0,"depth":1}},"children":["aVeYHZhqxCN6QJqFP6Ri5","GRvxv332whjrUYDFp1Ziq","BU0AIxveiMP6NB2YrRcth"],"parent":null,"data":{},"body":"\n# Module\n\n- [[Betriebssysteme]]\n- [[Datenbanken]]\n- [[Stochastik]]"},"collectionChildren":null,"customHeadContent":null,"config":{"version":4,"useFMTitle":true,"useNoteTitleForLink":true,"mermaid":true,"useKatex":true,"dev":{"enablePreviewV2":true},"site":{"copyAssets":true,"siteHierarchies":["root"],"siteRootDir":"docs","usePrettyRefs":true,"title":"Dendron","description":"Personal knowledge space","siteLastModified":true,"gh_edit_branch":"main","siteUrl":"https://herrmanno.github.io","assetsPrefix":"/knowledge-base","usePrettyLinks":true,"siteNotesDir":"notes","siteFaviconPath":"favicon.ico","gh_edit_link":true,"gh_edit_link_text":"Edit this page on GitHub","gh_root":"docs/","gh_edit_view_mode":"edit","writeStubs":true,"siteIndex":"root"},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":false,"leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNote":{"initialValue":"templates"},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false}},"workspace":{"vaults":[{"fsPath":"uni","name":"Uni"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link"},"graph":{"zoomSpeed":1},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false}}},"__N_SSG":true}